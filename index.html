<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Bangkok 2026 (Scent & Stroll)</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Noto+Serif+TC:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
    --bg-body: #F5F5F0;
    --bg-card: #FFFFFF; 
    --text-main: #1A1A2E; 
    --text-sub: #555555; 
    --accent: #D4AF37; 
    --accent-hover: #B5932A;
    --border: #E0E0E0; 
    --header-bg: #1A1A2E;
    --header-text: #D4AF37;
    --shadow: 0 2px 8px rgba(26, 26, 46, 0.06);
    --sidebar-width: 320px;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    font-family: "Noto Serif TC", serif;
    background-color: var(--bg-body);
    color: var(--text-main);
    margin: 0; padding: 0;
    height: 100vh;
    display: flex; flex-direction: column; overflow: hidden;
}

h1, h2, h3, .weather-temp-lg, .day-num, .phrase-big, .curr-rate-disp { font-family: "Playfair Display", serif; }

/* --- Header --- */
header {
    padding: 0 15px;
    background-color: var(--header-bg);
    color: var(--header-text);
    border-bottom: 1px solid var(--accent);
    display: flex; justify-content: space-between; align-items: center;
    height: 55px; flex-shrink: 0; position: relative; z-index: 200;
}
header h1 { margin: 0; font-size: 1.1rem; font-weight: 700; letter-spacing: 1px; color: var(--accent); }
.header-actions { display: flex; align-items: center; gap: 5px; }
.header-btn { 
    font-size: 1.1rem; cursor: pointer; color: #FFF; 
    border-radius: 50%; width: 40px; height: 40px;
    display: flex; justify-content: center; align-items: center;
}

/* --- Sidebar --- */
.sidebar-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(26, 26, 46, 0.6); z-index: 1000;
    opacity: 0; pointer-events: none; transition: opacity 0.3s;
    backdrop-filter: blur(3px);
}
.sidebar-overlay.open { opacity: 1; pointer-events: all; }

.sidebar {
    position: fixed; top: 0; right: 0; width: 85%; max-width: var(--sidebar-width); height: 100%;
    background: #FFF; z-index: 1001;
    transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    overflow-y: auto; padding: 25px 20px;
    box-shadow: -5px 0 20px rgba(0,0,0,0.1);
    display: flex; flex-direction: column;
}
.sidebar.open { transform: translateX(0); }
.sidebar-section-title { font-size: 0.75rem; color: var(--accent); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px; margin-top: 25px; font-weight: 700; border-bottom: 1px solid #EEE; padding-bottom: 5px; }

/* Info Widgets in Sidebar */
.info-widget { background: #FAFAFA; border: 1px solid #EEE; border-radius: 8px; padding: 15px; margin-bottom: 10px; }
.info-header { display: flex; align-items: center; gap: 8px; font-weight: 700; color: var(--text-main); margin-bottom: 8px; font-size: 0.95rem; }
.info-content { font-size: 0.85rem; color: #555; margin-bottom: 12px; line-height: 1.4; }
.info-actions { display: flex; gap: 8px; }
.btn-sidebar-action { flex: 1; padding: 8px; border: 1px solid #DDD; background: #FFF; border-radius: 4px; color: var(--text-main); font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px; font-weight: 500;}
.btn-sidebar-action:active { background: #EEE; }

.flight-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; font-size: 0.9rem; border-bottom: 1px dashed #EEE; padding-bottom: 4px; }
.flight-row:last-child { border-bottom: none; margin-bottom: 0; }
.flight-label { font-size: 0.7rem; color: var(--accent); font-weight: bold; background: var(--text-main); padding: 2px 6px; border-radius: 3px; margin-right: 8px; width: 25px; text-align: center; display: inline-block;}

/* Tools */
.tool-box { background: #FFF; padding: 15px; border-radius: 8px; border: 1px solid #EEE; margin-bottom: 10px; box-shadow: var(--shadow); }
.currency-grid { display: grid; grid-template-columns: 1fr 30px 1fr; align-items: center; gap: 5px; margin-bottom: 8px; }
.curr-group { display: flex; flex-direction: column; }
.curr-label { font-size: 0.7rem; color: var(--accent); font-weight: bold; margin-bottom: 4px; }
.curr-input { width: 100%; padding: 8px; border: 1px solid #DDD; border-radius: 4px; font-size: 1.1rem; text-align: center; background: #FAFAFA; font-weight: 500; font-family: 'Playfair Display', serif; color: var(--text-main); }
.curr-icon { text-align: center; color: #CCC; font-size: 0.9rem; margin-top: 15px;} 
.rate-control { display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; color: #888; margin-top: 5px; padding: 0 2px;}
.edit-rate-btn { color: var(--text-main); cursor: pointer; text-decoration: underline; margin-left: 5px; }

/* --- Common Pages --- */
.weather-main-card { background: linear-gradient(135deg, #1A1A2E, #303055); color: var(--accent); border-radius: 12px; padding: 20px; margin: 0 15px 15px 15px; box-shadow: 0 10px 25px rgba(26, 26, 46, 0.3); text-align: center; border: 1px solid rgba(212, 175, 55, 0.3); }
.weather-icon-lg { font-size: 3.5rem; margin: 10px 0; color: #FFF; }
.weather-temp-lg { font-size: 3rem; font-weight: 400; color: var(--accent); }
.weather-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 0 15px; }
.weather-stat-card { background: #FFF; border: 1px solid #EEE; padding: 10px; border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: var(--shadow); }

.date-selector-container { background: var(--bg-card); padding: 10px 15px; border-bottom: 1px solid var(--border); width: 100%; flex-shrink: 0; position: relative; z-index: 90; display: block; }
.date-selector { display: flex; gap: 8px; overflow-x: auto; scrollbar-width: none; padding-bottom: 5px; }
.date-chip { flex: 1 0 auto; min-width: 65px; padding: 10px 0; border-radius: 4px; cursor: pointer; color: var(--text-sub); display: flex; flex-direction: column; align-items: center; justify-content: center; background: #F5F5F0; border: 1px solid transparent; transition: all 0.2s; }
.date-chip.active { background: var(--text-main); color: var(--accent); border-color: var(--accent); }
.day-num { font-weight: 700; font-size: 0.95rem; margin-bottom: 2px;} 
.day-week { font-size: 0.65rem; text-transform: uppercase; }

main { flex: 1; overflow-y: hidden; position: relative; }
.page { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow-y: auto; padding: 20px 0 100px 0; display: none; opacity: 0; transition: opacity 0.2s ease; background-color: var(--bg-body); }
.page.active { display: block; opacity: 1; z-index: 10; }

/* --- Compact Timeline --- */
.timeline-container { padding: 0 15px; max-width: 800px; margin: 0 auto; }
.timeline-item { position: relative; padding-left: 24px; padding-bottom: 15px; border-left: 1px solid #CCC; } 
.timeline-item:last-child { border-left: 1px solid transparent; }
.timeline-item::before { content: ''; position: absolute; left: -5px; top: 18px; width: 9px; height: 9px; background: var(--bg-body); border: 2px solid var(--accent); border-radius: 50%; box-shadow: 0 0 0 3px var(--bg-body); z-index: 2; }

.card { 
    background-color: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; 
    padding: 12px 15px; 
    box-shadow: var(--shadow); cursor: pointer; position: relative; 
}
.card:active { background-color: #FAFAFA; }
.card-time { font-size: 0.75rem; color: var(--accent); font-weight: 600; margin-bottom: 4px; display: block; }
.card-title { font-size: 1.05rem; font-weight: 700; margin: 0 0 6px 0; padding-right: 25px; color: var(--text-main); line-height: 1.3; }
.tags { display: flex; gap: 5px; flex-wrap: wrap; margin-top: 4px; }
.card-tag { font-size: 0.65rem; background: #F5F5F0; padding: 2px 10px; border-radius: 20px; color: #666; border: 1px solid #E0E0E0; }
.card-nav-btn { position: absolute; top: 12px; right: 12px; width: 28px; height: 28px; border-radius: 50%; background: #F8F8F8; color: var(--text-main); display: flex; justify-content: center; align-items: center; font-size: 0.8rem; border: 1px solid #DDD; z-index: 5; }

/* --- Inspiration / Shopping --- */
.filter-bar-container { padding: 0 15px 10px 15px; position: sticky; top: 0; z-index: 50; background: var(--bg-body); overflow-x: auto; white-space: nowrap; scrollbar-width: none; }
.filter-chip { display: inline-block; padding: 6px 14px; margin-right: 6px; background: #FFF; border: 1px solid #DDD; border-radius: 20px; font-size: 0.8rem; color: #555; cursor: pointer; }
.filter-chip.active { background: var(--text-main); color: var(--accent); border-color: var(--text-main); }
.inspiration-grid { padding: 0 15px; display: grid; gap: 10px; }
.inspire-card { 
    background: #FFF; border: 1px solid #E0E0E0; border-radius: 6px; padding: 15px; 
    position: relative; display: block; box-shadow: var(--shadow); cursor: pointer;
}
.inspire-card.hidden { display: none; }
.inspire-badge { background: var(--accent); color: #FFF; padding: 2px 8px; border-radius: 4px; font-size: 0.65rem; font-weight: bold; position: absolute; top: 12px; right: 12px; letter-spacing: 0.5px; }
.inspire-title { margin: 0 0 5px 0; font-size: 1rem; font-weight: 700; color: var(--text-main); padding-right: 50px;}
.inspire-desc { margin: 0; font-size: 0.85rem; color: #666; line-height: 1.4; }

.shop-item { background: #FFF; padding: 12px 15px; border-bottom: 1px solid #EEE; display: flex; align-items: center; gap: 10px; border-radius: 6px; margin-bottom: 8px; box-shadow: var(--shadow); margin: 0 15px 8px 15px; }

/* --- Phrases --- */
.phrase-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 0 15px; }
.phrase-card { background: #FFF; border: 1px solid var(--border); padding: 15px 10px; border-radius: 6px; text-align: center; cursor: pointer; box-shadow: var(--shadow); aspect-ratio: 1.3; display: flex; flex-direction: column; justify-content: center; align-items: center; }
.phrase-jp { font-weight: 700; font-size: 1rem; margin-bottom: 5px; color: var(--text-main); }
.phrase-zh { font-size: 0.8rem; color: #888; }
.phrase-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); z-index: 5000; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
.phrase-overlay.active { opacity: 1; pointer-events: all; }
.phrase-content { text-align: center; width: 85%; }
.phrase-big { font-size: 2.2rem; font-weight: 700; color: var(--text-main); line-height: 1.3; margin-bottom: 15px; word-break: break-word; }
.close-phrase { position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%); border: 1px solid var(--text-main); padding: 10px 30px; border-radius: 30px; color: var(--text-main); cursor: pointer; font-weight: 600; }

/* --- Modal --- */
.modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; justify-content: center; align-items: end; backdrop-filter: blur(3px); }
.modal.open { display: flex; }
.modal-content { background: #FFF; width: 100%; max-width: 600px; max-height: 90vh; border-radius: 20px 20px 0 0; padding: 25px; overflow-y: auto; animation: slideUp 0.3s ease; display: flex; flex-direction: column; }
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
#modal-mini-map { width: 100%; height: 180px; background: #EEE; border-radius: 12px; margin-bottom: 20px; border: 1px solid #DDD; flex-shrink: 0;}
.modal-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0; }
.modal-label { font-size: 0.65rem; color: #999; text-transform: uppercase; letter-spacing: 1.5px; display: block; margin-bottom: 3px; }
.modal-value { font-size: 0.95rem; font-weight: 500; color: var(--text-main); }
.modal-note-box { background: #F5F5F0; padding: 15px; border-radius: 8px; border-left: 3px solid var(--accent); margin: 15px 0; }
.modal-note-content { font-size: 0.9rem; line-height: 1.6; white-space: pre-line; color: #444; }
.btn-action { width: 100%; padding: 14px; border-radius: 6px; border: none; font-weight: 600; cursor: pointer; font-size: 0.95rem; text-align: center; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px;}
.btn-black { background: var(--text-main); color: var(--accent); }
.btn-grab { background: #00B14F; color: white; }

nav.bottom-nav { position: fixed; bottom: 0; width: 100%; background-color: #FFF; display: flex; justify-content: space-around; padding: 10px 0 20px 0; border-top: 1px solid var(--border); z-index: 100; box-shadow: 0 -5px 15px rgba(0,0,0,0.03); }
.nav-item { color: #CCC; text-align: center; font-size: 0.7rem; cursor: pointer; width: 25%; }
.nav-item i { display: block; font-size: 1.2rem; margin-bottom: 4px; }
.nav-item.active { color: var(--text-main); }
</style>
</head>
<body>

<header>
<h1>BANGKOK <span style="font-weight:300; opacity:0.7; font-size:0.8rem;">2026</span></h1>
<div class="header-actions">
<div class="header-btn" onclick="openTranslate()"><i class="fa-solid fa-language"></i></div>
<div class="header-btn" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></div>
</div>
</header>

<div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>
<div class="sidebar" id="sidebar">

<div class="sidebar-section-title" style="margin-top:0;">å¯¦ç”¨è³‡è¨Šå¡ç‰‡</div>
<div class="info-widget">
    <div class="info-header"><i class="fa-solid fa-hotel"></i> IR-ON Hotel</div>
    <div class="info-content">10/10 Sukhumvit Soi 36, Bangkok<br><span style="font-size:0.8em; color:#888;">BTS Thong Lo ç«™</span></div>
    <div class="info-actions">
        <div class="btn-sidebar-action" onclick="openMapQuery('IR-ON Hotel Sukhumvit 36')"><i class="fa-solid fa-map-location-dot"></i> å°èˆª</div>
        <div class="btn-sidebar-action" style="background:var(--text-main); color:var(--accent); border:none;" onclick="showPhrase('à¹„à¸›à¹‚à¸£à¸‡à¹à¸£à¸¡ IR-ON à¸ªà¸¸à¸‚à¸¸à¸¡à¸§à¸´à¸— 36', 'è«‹è¼‰æˆ‘å» IR-ON Hotel')"><i class="fa-solid fa-taxi"></i> çµ¦å¸æ©Ÿçœ‹</div>
    </div>
</div>

<div class="info-widget">
    <div class="info-header"><i class="fa-solid fa-plane"></i> èˆªç­è³‡è¨Š</div>
    <div class="flight-row">
        <div><span class="flight-label">å»</span> <b>CX755</b></div>
        <span style="font-size:0.8em; color:#888;">HKG â” BKK</span>
    </div>
    <div class="flight-row">
        <div><span class="flight-label">å›</span> <b>CX706</b></div>
        <span style="font-size:0.8em; color:#888;">BKK â” HKG</span>
    </div>
</div>

<div class="sidebar-section-title">ç™¾å¯¶ç®±</div>
<div class="tool-box">
<div style="font-weight:bold; margin-bottom:10px; color:var(--text-main); font-size:0.9rem;"><i class="fa-solid fa-coins"></i> åŒ¯ç‡è¨ˆç®— (THB â‡„ HKD)</div>
<div class="currency-grid">
<div class="curr-group"><span class="curr-label">THB</span><input type="number" id="curr-thb" class="curr-input" placeholder="0" oninput="convertCurrency()"></div>
<div class="curr-icon"><i class="fa-solid fa-right-left"></i></div>
<div class="curr-group"><span class="curr-label">HKD</span><input type="number" id="curr-hkd" class="curr-input" placeholder="0" readonly style="background:#EEE;"></div>
</div>
<div class="rate-control">
    <span id="rate-display-text">è¼‰å…¥ä¸­...</span>
    <div onclick="manualRate()" class="edit-rate-btn"><i class="fa-solid fa-pen-to-square"></i> æ‰‹å‹•è¼¸å…¥</div>
</div>
</div>

<div class="nav-launcher" onclick="navigateTo('phrases')" style="padding:10px; margin-top:5px; cursor:pointer; background:#FAFAFA; border:1px solid #EEE; border-radius:8px;">
<div style="display:flex; align-items:center; gap:10px;">
    <div style="color:var(--accent); font-size:1.1rem;"><i class="fa-solid fa-comments"></i></div>
    <div><div style="font-weight:bold; font-size:0.9rem;">æ³°èªæ‰‹æŒ‡å¡</div><div style="font-size:0.75rem; color:#888;">å¾®è¾£ã€ä¸åŠ ç³–ã€äº¤é€šç”¨èª</div></div>
</div>
</div>

</div>

<div id="phrase-overlay" class="phrase-overlay" onclick="closePhrase()">
<div class="phrase-content"><div id="overlay-jp" class="phrase-big"></div><div id="overlay-zh" class="phrase-sub"></div></div>
<div class="close-phrase">é»æ“Šé—œé–‰</div>
</div>

<div class="date-selector-container">
<div class="date-selector" id="date-selector"></div>
</div>

<main>
<div id="page-itinerary" class="page active">
<div class="timeline-container" id="timeline-container"></div>
</div>

<div id="page-inspiration" class="page">
<div class="filter-bar-container">
<span class="filter-chip active" onclick="filterInspiration('all', this)">å…¨éƒ¨</span>
<span class="filter-chip" onclick="filterInspiration('RAINY', this)">â˜” é›¨å¤©/å®¤å…§</span>
<span class="filter-chip" onclick="filterInspiration('RELAX', this)">â˜• æ”¾é¬†/å’–å•¡</span>
<span class="filter-chip" onclick="filterInspiration('NIGHT', this)">ğŸŒ™ æ™šé–“/å°é…Œ</span>
</div>
<div id="inspiration-container" class="inspiration-grid"></div>
</div>

<div id="page-shopping" class="page">
<div id="shopping-container" class="shopping-list" style="margin-top:10px;"></div>
</div>

<div id="page-weather" class="page">
<div id="weather-content">
<div style="text-align:center; padding:50px; opacity:0.5;"><i class="fa-solid fa-spinner fa-spin fa-2x"></i><p>è¼‰å…¥ä¸­...</p></div>
</div>
<div class="weather-notice" id="weather-notice" style="text-align:center; font-size:0.75rem; color:#666; margin:10px 20px; padding:10px; background:rgba(212, 175, 55, 0.1); border-radius:6px;"></div>
</div>

<div id="page-phrases" class="page">
<div style="padding:0 15px 15px 15px;"><h2 class="page-title" style="font-size:1.5rem;">æ³°èªæºé€šå¡</h2></div>
<div class="sidebar-section-title" style="margin-left:15px; border:none; margin-top:0;">é£²é£Ÿå®¢è£½</div>
<div class="phrase-grid">
<div class="phrase-card" onclick="showPhrase('à¹€à¸œà¹‡à¸”à¸™à¸´à¸”à¸«à¸™à¹ˆà¸­à¸¢', 'å¾®è¾£ (Pet-Nit-Noi)')"><div class="phrase-jp">à¹€à¸œà¹‡à¸”à¸™à¸´à¸”à¸«à¸™à¹ˆà¸­à¸¢</div><div class="phrase-zh">å¾®è¾£ (å¥½é£Ÿ!)</div></div>
<div class="phrase-card" onclick="showPhrase('à¹„à¸¡à¹ˆà¹€à¸­à¸²à¹€à¸œà¹‡à¸”', 'ä¸è¦è¾£ (Mai-ao-phet)')"><div class="phrase-jp">à¹„à¸¡à¹ˆà¹€à¸­à¸²à¹€à¸œà¹‡à¸”</div><div class="phrase-zh">ä¸è¦è¾£</div></div>
<div class="phrase-card" onclick="showPhrase('à¹„à¸¡à¹ˆà¹€à¸­à¸²à¸œà¸±à¸à¸Šà¸µ', 'ä¸è¦é¦™èœ (Mai-ao-pak-chi)')"><div class="phrase-jp">à¹„à¸¡à¹ˆà¹€à¸­à¸²à¸œà¸±à¸à¸Šà¸µ</div><div class="phrase-zh">ä¸è¦é¦™èœ</div></div>
<div class="phrase-card" onclick="showPhrase('à¹„à¸¡à¹ˆà¹€à¸­à¸²à¸«à¸§à¸²à¸™', 'ä¸è¦ç³– (Mai-ao-wan)')"><div class="phrase-jp">à¹„à¸¡à¹ˆà¹€à¸­à¸²à¸«à¸§à¸²à¸™</div><div class="phrase-zh">ä¸è¦ç³– (æ³°å¥¶ç”¨)</div></div>
</div>
<div class="sidebar-section-title" style="margin-left:15px; border:none;">æ—¥å¸¸</div>
<div class="phrase-grid">
<div class="phrase-card" onclick="showPhrase('à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°', 'ä½ å¥½ (Sa-wa-dee-ka)')"><div class="phrase-jp">à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°</div><div class="phrase-zh">ä½ å¥½ (å¥³)</div></div>
<div class="phrase-card" onclick="showPhrase('à¸‚à¸­à¸šà¸„à¸¸à¸“à¸„à¹ˆà¸°', 'è¬è¬ (Khop-khun-ka)')"><div class="phrase-jp">à¸‚à¸­à¸šà¸„à¸¸à¸“à¸„à¹ˆà¸°</div><div class="phrase-zh">è¬è¬ (å¥³)</div></div>
<div class="phrase-card" onclick="showPhrase('à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?', 'æ´—æ‰‹é–“åœ¨å“ªè£¡ï¼Ÿ')"><div class="phrase-jp">à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³...</div><div class="phrase-zh">æ´—æ‰‹é–“åœ¨å“ªï¼Ÿ</div></div>
<div class="phrase-card" onclick="showPhrase('à¸¥à¸”à¹„à¸”à¹‰à¹„à¸«à¸¡?', 'å¯ä»¥ä¾¿å®œé»å—? (Lot-dai-mai)')"><div class="phrase-jp">à¸¥à¸”à¹„à¸”à¹‰à¹„à¸«à¸¡?</div><div class="phrase-zh">å¯ä»¥ä¾¿å®œé»å—?</div></div>
</div>
<div class="sidebar-section-title" style="margin-left:15px; border:none;">äº¤é€š</div>
<div class="phrase-grid">
<div class="phrase-card" onclick="showPhrase('à¹„à¸›à¸—à¸µà¹ˆà¸™à¸µà¹ˆà¸„à¸£à¸±à¸š/à¸„à¹ˆà¸°', 'æˆ‘è¦å»é€™è£¡ (Pai-tee-nee)')"><div class="phrase-jp">à¹„à¸›à¸—à¸µà¹ˆà¸™à¸µà¹ˆ...</div><div class="phrase-zh">æˆ‘è¦å»é€™è£¡</div></div>
<div class="phrase-card" onclick="showPhrase('à¸ˆà¸­à¸”à¸—à¸µà¹ˆà¸™à¸µà¹ˆ', 'åœ¨æ­¤åœè»Š (Jort-tee-nee)')"><div class="phrase-jp">à¸ˆà¸­à¸”à¸—à¸µà¹ˆà¸™à¸µà¹ˆ</div><div class="phrase-zh">é€™è£¡åœ</div></div>
</div>
</div>
</main>

<nav class="bottom-nav">
<div class="nav-item active" onclick="switchMainPage('itinerary', this)"><i class="fa-regular fa-calendar"></i><span>è¡Œç¨‹</span></div>
<div class="nav-item" onclick="switchMainPage('inspiration', this)"><i class="fa-regular fa-compass"></i><span>æ¢ç´¢</span></div>
<div class="nav-item" onclick="switchMainPage('shopping', this)"><i class="fa-solid fa-bag-shopping"></i><span>æ¸…å–®</span></div>
<div class="nav-item" onclick="switchMainPage('weather', this)"><i class="fa-solid fa-cloud"></i><span>å¤©æ°£</span></div>
</nav>

<div id="detail-modal" class="modal">
<div class="modal-content">
<div style="position:absolute; top:15px; right:20px; font-size:1.8rem; cursor:pointer; color:#888;" onclick="closeModal()">Ã—</div>
<div id="modal-mini-map"></div>
<div class="modal-header">
<span class="modal-label" id="modal-type">Type</span>
<h2 id="modal-title" style="margin:0; font-family:'Playfair Display', serif; font-size:1.4rem;">Title</h2>
</div>
<div class="modal-info-grid">
<div><span class="modal-label">æ™‚é–“</span><span class="modal-value" id="modal-time"></span></div>
<div><span class="modal-label">é ç®—</span><span class="modal-value" id="modal-price"></span></div>
<div><span class="modal-label">ç‡Ÿæ¥­æ™‚é–“</span><span class="modal-value" id="modal-open-hours"></span></div>
<div><span class="modal-label">åœ°å€</span><span class="modal-value" id="modal-address-short" style="font-size:0.85rem; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; display:block;"></span></div>
</div>
<div class="modal-label">å‚™è¨»èˆ‡æ”»ç•¥</div>
<div class="modal-note-box"><div id="modal-note" class="modal-note-content"></div></div>
<div class="modal-actions" id="modal-actions"></div>
</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// --- DATA: BANGKOK 2026 (UPDATED) ---
const scheduleData = {
"day1": { 
    "date": "2026-04-03", "display": "Apr 03", "weekday": "é€±äº”", 
    "events": [ 
        { time: "10:30", title: "æŠµé” & IR-ON Hotel", type: "äº¤é€š/Check-in", price: "à¸¿60", open_hours: "24H", address: "IR-ON Hotel, Sukhumvit 36", coords: [13.7237, 100.5772], note: "ARL è½‰ BTS åˆ° Thong Loï¼Œ2è™Ÿå‡ºå£ä¸‹æ¨“å¾Œè¿´è½‰é€² Soi 36ã€‚é£¯åº—è¨­è¨ˆæ„Ÿå¼·ï¼Œé©åˆæ‹ç…§ã€‚", tags: ["ç§»å‹•"] },
        { time: "13:00", title: "Supanniga Eating Room", type: "ç±³å…¶æ—æ³°èœ", price: "à¸¿1,500", open_hours: "10-22", address: "Supanniga Eating Room Thong Lo", coords: [13.7314, 100.5816], note: "å¿…é»ï¼šèŸ¹è‚‰çƒ˜è›‹ (Khai Jiew Pu)ã€é¦¬æ’’æ›¼å’–å“©ç‰›ã€‚åˆé¤æ™‚æ®µäººè¼ƒå°‘ã€‚", tags: ["ç¾é£Ÿ"] },
        { time: "15:00", title: "Jim Thompson House", type: "åšç‰©é¤¨", price: "à¸¿200", open_hours: "10-18", address: "Jim Thompson House Museum", coords: [13.7495, 100.5284], note: "BTS National Stadium 1è™Ÿå‡ºå£ã€‚æ³°çµ²å¤§ç‹çš„æ•…å±…ï¼Œå°è¦½éå¸¸å°ˆæ¥­ã€‚", tags: ["æ–‡åŒ–"] },
        { time: "16:30", title: "Siam Square (é¦™æ°›)", type: "è³¼ç‰©", price: "-", open_hours: "10-22", address: "Siam Square One", coords: [13.7444, 100.5349], note: "Journal: Siam Square One LG å±¤\nCopenn.: Firster è³£å ´å…§ã€‚\nè©¦é¦™å¥½å»è™•ã€‚", tags: ["é€›è¡—"] },
        { time: "18:30", title: "Sra Bua by Kiin Kiin", type: "ç±³å…¶æ—ä¸€æ˜Ÿ", price: "à¸¿3,500+", open_hours: "18-24", address: "Sra Bua by Kiin Kiin", coords: [13.7485, 100.5348], note: "åˆ†å­æ–™ç†æ³°èœï¼Œè¦–è¦ºæ•ˆæœæ¥µä½³ã€‚\nDress Code: Smart Casual (å‹¿çŸ­è¤²æ‹–é‹)ã€‚", tags: ["Fine Dining"] },
        { time: "21:00", title: "Asia Herb Association", type: "Spa", price: "à¸¿1,500+", open_hours: "09-02", address: "Asia Herb Association Thong Lo", coords: [13.7258, 100.5783], note: "Thong Lo ç«™ 3 è™Ÿå‡ºå£ã€‚é¦–æ—¥æ¨è–¦ï¼š100% ç´”ç²¾æ²¹æŒ‰æ‘© (60min)ã€‚", tags: ["æŒ‰æ‘©"] }
    ], 
    "inspiration": [
        {title:"Let's Relax Onsen", type:"Spa/æº«æ³‰", tag:"RELAX", price:"à¸¿750", open_hours:"10-24", address:"Grande Centre Point Sukhumvit 55", coords:[13.7313, 100.5815], note:"å¦‚æœä½ ä¸æƒ³æŒ‰æ‘©ï¼Œé€™è£¡æœ‰æ—¥å¼æº«æ³‰ï¼Œéå¸¸ä¹¾æ·¨ï¼Œå†·æ°£å¾ˆå¼·ï¼Œé©åˆé¿æš‘ã€‚"},
        {title:"Patom Organic Living", type:"Cafe", tag:"RELAX", price:"à¸¿300", open_hours:"09-19", address:"Patom Organic Living", coords:[13.7366, 100.5778], note:"ç»ç’ƒå±‹èˆ‡å¤§èŠ±åœ’ï¼Œåœ¨ Thong Lo è£¡çš„ç¶ æ´²ã€‚æ¨è–¦æœ‰æ©Ÿå’–å•¡å’Œæ³°å¼å‚³çµ±é»å¿ƒã€‚"},
        {title:"BACC è—è¡“ä¸­å¿ƒ", type:"å±•è¦½", tag:"RAINY", price:"å…è²»", open_hours:"10-20", address:"Bangkok Art and Culture Centre", coords:[13.7467, 100.5303], note:"å°±åœ¨ Siam å€ï¼Œä¸‹é›¨æœ€ä½³å‚™æ¡ˆã€‚å»ºç¯‰æœ¬èº«çš„èºæ—‹èµ°é“å¾ˆç¾ï¼Œæœ‰å¾ˆå¤šå°è¨­è¨ˆåº—ã€‚"},
        {title:"Tichuca Rooftop Bar", type:"é…’å§", tag:"NIGHT", price:"à¸¿500+", open_hours:"17-24", address:"T-One Building 46F", coords:[13.7229, 100.5807], note:"è‘—åçš„æ°´æ¯é…’å§ï¼Œå°±åœ¨ä½ é£¯åº—éš”å£æ£Ÿ (T-One)ã€‚äººå¤šå»ºè­°æ—©é»å»ä½”ä½ã€‚"}
    ],
    "shopping": ["Journal æ²‰é¦™é¦™æ°´", "Copenn. è­·æ‰‹éœœ", "Jim Thompson çµ²å·¾"] 
},
"day2": { 
    "date": "2026-04-04", "display": "Apr 04", "weekday": "é€±å…­", 
    "events": [ 
        { time: "10:00", title: "æ°åœ–æ°é€±æœ«å¸‚é›†", type: "å¸‚é›†", price: "-", open_hours: "09-18", address: "Chatuchak Weekend Market", coords: [13.8033, 100.5512], note: "é‡é»æ”»ä½” Section 2-4 (è¨­è¨ˆå¸«å€) å’Œ Section 26 (å¤è‘£å€)ã€‚éå¸¸ç†±ï¼Œè¨˜å¾—å¸¶æ°´ã€‚", tags: ["é€›è¡—"] },
        { time: "12:30", title: "Copper Beyond Buffet", type: "è‡ªåŠ©é¤", price: "à¸¿2,000", open_hours: "10-20", address: "Gaysorn Amarin", coords: [13.7443, 100.5414], note: "éœ€æå‰è¨‚ä½ã€‚å¿…åƒï¼šå’Œç‰›èˆ¹éºµã€é»‘æ¾éœ²æ¿ƒæ¹¯ã€æ³°å¼ç”Ÿè ”ã€‚ç’°å¢ƒæ¥µä½³ã€‚", tags: ["ç¾é£Ÿ"] },
        { time: "15:00", title: "é£¯åº—é¿æš‘ / æˆ°åˆ©å“æ•´ç†", type: "ä¼‘æ¯", price: "-", open_hours: "-", address: "IR-ON Hotel", coords: [13.7237, 100.5772], note: "ä¸‹åˆ3é»æ›¼è°·æœ€ç†±ï¼Œå»ºè­°å›é£¯åº—æ²–æ¾¡ã€æ•´ç†ä¸Šåˆå¸‚é›†è²·çš„æ±è¥¿ã€‚", tags: ["ä¼‘æ¯"] },
        { time: "16:30", title: "Asia Herb Association", type: "Spa", price: "-", open_hours: "09-02", address: "Asia Herb Association Thong Lo", coords: [13.7258, 100.5783], note: "æ¨è–¦ï¼šæ³°å¼æŒ‰æ‘© + ç”Ÿè‰è—¥çƒç†±æ•· (Herbal Ball)ï¼Œå°ˆé–€æ¶ˆé™¤èµ°è·¯å¾Œçš„è…¿ç— ã€‚", tags: ["æŒ‰æ‘©"] },
        { time: "18:30", title: "Mae Varee èŠ’æœç³¯ç±³", type: "å°åƒ", price: "à¸¿150", open_hours: "06-22", address: "Mae Varee Mango Sticky Rice", coords: [13.7250, 100.5780], note: "Thong Lo ç«™æ—ã€‚å…¨æ›¼è°·æœ€å¥½åƒçš„ä¸‰è‰²ç³¯ç±³ï¼Œè²·å›é£¯åº—åƒæˆ–ç•¶å®µå¤œã€‚", tags: ["ç”œé»"] },
        { time: "19:30", title: "Paper Plane Project", type: "Bar / Coworking", price: "à¸¿500+", open_hours: "09-01", address: "T-One Building", coords: [13.7229, 100.5807], note: "å°±åœ¨é£¯åº—æ— T-One å¤§æ¨“ 40Fã€‚ç™½å¤©æ˜¯è¾¦å…¬å®¤ï¼Œæ™šä¸Šè®Šé…’å§ï¼ŒéŸ³æ¨‚å¾ˆæœ‰å“å‘³ã€‚", tags: ["Bar"] }
    ], 
    "inspiration": [
        {title:"Mixt Chatuchak", type:"å•†å ´", tag:"RAINY", price:"-", open_hours:"10-20", address:"Mixt Chatuchak", coords:[13.8025, 100.5510], note:"å°±åœ¨æ°åœ–æ°å¸‚é›†éš”å£çš„å†·æ°£å•†å ´ï¼Œå¦‚æœå¸‚é›†å¤ªç†±æˆ–ä¸‹é›¨ï¼Œç›´æ¥èº²é€²ä¾†ï¼Œé€™è£¡ä¹Ÿæœ‰å¾ˆå¤šæ–‡å‰µæ”¤ä½ã€‚"},
        {title:"Roots at the Commons", type:"Cafe", tag:"RELAX", price:"à¸¿150", open_hours:"08-20", address:"The Commons Thong Lo", coords:[13.7348, 100.5822], note:"æ›¼è°·è‘—åçš„ç²¾å“å’–å•¡ï¼Œä½æ–¼æ¸…æ°´æ¨¡å»ºç¯‰ The Commons å…§ï¼Œé€šé¢¨å¥½ï¼Œæ°›åœæ¥µä½³ã€‚"},
        {title:"MOCA ç•¶ä»£è—è¡“é¤¨", type:"åšç‰©é¤¨", tag:"RAINY", price:"à¸¿250", open_hours:"10-18", address:"MOCA Bangkok", coords:[13.8523, 100.5627], note:"å¦‚æœæ°åœ–æ°å¤ªæ“æ“ ï¼Œæ­è»Šå¾€åŒ—ä¸€é»åˆ° MOCAï¼Œå»ºç¯‰èˆ‡å…‰å½±æ¥µç¾ï¼Œéå¸¸å®‰éœå†·é–€ã€‚"},
        {title:"Jodd Fairs Rama 9", type:"å¤œå¸‚", tag:"NIGHT", price:"-", open_hours:"16-24", address:"Jodd Fairs Rama 9", coords:[13.7569, 100.5663], note:"å¦‚æœæ™šä¸Šæƒ³é€›å¤œå¸‚ï¼Œé€™è£¡æ¯”æ°åœ–æ°æ›´æœ‰åƒçš„ï¼Œç«å±±æ’éª¨ã€æ°´æœè¥¿æ–½éƒ½åœ¨é€™ã€‚"}
    ],
    "shopping": ["Hem Aroma é¦™æ°›", "äºŒæ‰‹å¤è‘£é›œè²¨", "è¨­è¨ˆå¸«Tæ¤"] 
},
"day3": { 
    "date": "2026-04-05", "display": "Apr 05", "weekday": "é€±æ—¥", 
    "events": [ 
        { time: "09:30", title: "è˜‡æ³°å¯º (Wat Suthat)", type: "å¯ºå»Ÿ/æ–‡åŒ–", price: "à¸¿100", open_hours: "08:30-21", address: "Wat Suthat Thepwararam", coords: [13.7513, 100.5011], note: "ç´…è‰²å¤§é¦éŸ†æ—ã€‚å£ç•«éå¸¸ç²¾ç¾ï¼ŒéŠå®¢æ¯”å¤§çš‡å®®å°‘å¾ˆå¤šï¼Œèƒ½å®‰éœæ¬£è³ã€‚", tags: ["æ–‡åŒ–"] },
        { time: "12:00", title: "The Mustang Blu", type: "é¤å»³/æ‹ç…§", price: "à¸¿800", open_hours: "11-21", address: "The Mustang Blu", coords: [13.7397, 100.5146], note: "ç™¾å¹´éŠ€è¡Œæ”¹å»ºçš„ç¶²ç´…é£¯åº—/é¤å»³ã€‚ä¸­é–“çš„æ—‹è½‰æ¨“æ¢¯èˆ‡æ¨™æœ¬è£é£¾éå¸¸ç¨ç‰¹ã€‚", tags: ["åˆé¤"] },
        { time: "14:30", title: "River City Bangkok", type: "è—è¡“/å¤è‘£", price: "-", open_hours: "10-20", address: "River City Bangkok", coords: [13.7299, 100.5132], note: "æ˜­æŠ«è€¶æ²³ç•”ã€‚3-4 æ¨“æœ‰å¾ˆå¤šå¤è‘£åº—å’Œç¾ä»£ç•«å»Šï¼Œå†·æ°£å¾ˆå¼·ï¼Œé©åˆåˆå¾Œæ•£æ­¥ã€‚", tags: ["é€›è¡—"] },
        { time: "18:30", title: "Paste Bangkok", type: "ç±³å…¶æ—ä¸€æ˜Ÿ", price: "à¸¿3,000+", open_hours: "18-23", address: "Paste Bangkok", coords: [13.7444, 100.5404], note: "Gaysorn Village 3æ¨“ã€‚ä¸»å»š Bee Satongun çš„å‚³çµ±å®®å»·èœå¾©åˆ»ï¼Œå¿…é»å’–å“©èŸ¹ã€‚", tags: ["Fine Dining"] },
        { time: "21:00", title: "Asia Herb Association", type: "Spa", price: "-", open_hours: "09-02", address: "Asia Herb Association Thong Lo", coords: [13.7258, 100.5783], note: "ä»Šæ™šåŠ å¼·è‚©é ¸ (Head & Shoulder)ï¼Œèˆ’ç·©ç™½å¤©é€›èˆŠåŸå€çš„ç–²å‹ã€‚", tags: ["æŒ‰æ‘©"] }
    ], 
    "inspiration": [
        {title:"Hong Sieng Kong", type:"Cafe", tag:"RELAX", price:"à¸¿200", open_hours:"10-20", address:"Hong Sieng Kong", coords:[13.7329, 100.5108], note:"Talad Noi å€çš„å¤å®…å’–å•¡å»³ï¼Œå¾Œé™¢ç›´æ¥è‡¨æ²³ï¼Œå……æ»¿ä¸­å¼å¤è‘£ï¼Œéå¸¸æœ‰å‘³é“ã€‚"},
        {title:"Museum of Siam", type:"åšç‰©é¤¨", tag:"RAINY", price:"à¸¿200", open_hours:"10-18", address:"Museum of Siam", coords:[13.7441, 100.4941], note:"äº’å‹•æ€§å¾ˆå¼·çš„åšç‰©é¤¨ï¼Œè¬›è¿°ã€Œä»€éº¼æ˜¯æ³°åœ‹äººã€ï¼Œå†·æ°£é–‹æ”¾ï¼Œå°±åœ¨è‡¥ä½›å¯ºé™„è¿‘ã€‚"},
        {title:"Tep Bar", type:"é…’å§", tag:"NIGHT", price:"à¸¿400", open_hours:"18-24", address:"Tep Bar", coords:[13.7394, 100.5131], note:"éš±è—åœ¨èˆŠåŸå··å¼„è£¡ï¼Œç¾å ´æ¼”å¥æ³°åœ‹å‚³çµ±æ¨‚å™¨ï¼Œå–çš„æ˜¯æ³°å¼è—¥è‰èª¿é…’ (Ya Dong)ã€‚"},
        {title:"Warehouse 30", type:"æ–‡å‰µ", tag:"RAINY", price:"-", open_hours:"11-20", address:"Warehouse 30", coords:[13.7282, 100.5146], note:"å°±åœ¨ River City æ—é‚Šï¼ŒäºŒæˆ°èˆŠå€‰åº«æ”¹å»ºçš„è—æ–‡ç©ºé–“ï¼Œæœ‰å¾ˆå¤šè¨­è¨ˆå°åº—ã€‚"}
    ],
    "shopping": ["River City è—è¡“å¡ç‰‡", "èˆŠåŸå€å¤ç©"] 
},
"day4": { 
    "date": "2026-04-06", "display": "Apr 06", "weekday": "é€±ä¸€", 
    "events": [ 
        { time: "10:30", title: "Erb Bespoke èª¿é¦™", type: "é«”é©—", price: "à¸¿2,500", open_hours: "10-20", address: "Erb Boutique Gaysorn Village", coords: [13.7444, 100.5404], note: "éœ€é ç´„ã€‚å°ˆæ¥­èª¿é¦™å¸«å”åŠ©ï¼Œèª¿è£½ä¸€ç“¶å°æœ‰ä½ åå­—çš„å°ˆå±¬é¦™æ°´ã€‚", tags: ["é¦™æ°›"] },
        { time: "12:30", title: "Copper Buffet (äºŒåˆ·)", type: "è‡ªåŠ©é¤", price: "à¸¿2,000", open_hours: "10-20", address: "Gaysorn Amarin", coords: [13.7443, 100.5414], note: "äºŒåˆ·é‡é»ï¼šå°ˆæ”»ä¸Šæ¬¡æ²’åƒå¤ çš„ç”œé»å€èˆ‡æ¾³æ´²å’Œç‰›æ¡å£½å¸ã€‚", tags: ["ç¾é£Ÿ"] },
        { time: "15:00", title: "Gourmet Market", type: "è¶…å¸‚æ¡è²·", price: "-", open_hours: "10-22", address: "EmQuartier Gourmet Market", coords: [13.7319, 100.5698], note: "BTS Phrom Phongã€‚é€™è£¡çš„ä¼´æ‰‹ç¦®å€è¦åŠƒæœ€å¥½ï¼Œè²·å®Œå¯ä»¥ç›´æ¥å›é£¯åº—æ‰“åŒ…ã€‚", tags: ["æ¡è²·"] },
        { time: "16:30", title: "Asia Herb (å¤§ä¿é¤Š)", type: "Spa", price: "à¸¿2,000+", open_hours: "09-02", address: "Asia Herb Association Thong Lo", coords: [13.7258, 100.5783], note: "æœ€å¾Œä¸€æ™šï¼š120åˆ†é˜ å…¨èº«ç²¾æ²¹ + è‰è—¥çƒ (Full Course)ã€‚", tags: ["æŒ‰æ‘©"] },
        { time: "19:00", title: "The Commons Thong Lo", type: "æ™šé¤/æ”¾é¬†", price: "-", open_hours: "08-01", address: "The Commons Thong Lo", coords: [13.7348, 100.5822], note: "æœ€å¾Œä¸€æ™šè¼•é¬†é»ï¼Œåœ¨ The Beer Cap å–æ¯ç²¾é‡€ï¼Œåƒé» Soul Food ç‚¸é›ã€‚", tags: ["æ”¾é¬†"] }
    ], 
    "inspiration": [
        {title:"EmSphere Mall", type:"å•†å ´", tag:"RAINY", price:"-", open_hours:"10-22", address:"EmSphere", coords:[13.7303, 100.5667], note:"æ›¼è°·æœ€æ–°æ½®çš„å•†å ´ï¼ŒIKEA åœ¨ä¸‰æ¨“ï¼Œé¤é£²å€éå¸¸å¼·å¤§ï¼Œå†·æ°£å¾ˆå¼·ã€‚"},
        {title:"Open House", type:"æ›¸åº—", tag:"RELAX", price:"-", open_hours:"10-22", address:"Central Embassy Level 6", coords:[13.7437, 100.5463], note:"ä½æ–¼ Central Embassy 6æ¨“ï¼Œè¢«è­½ç‚ºæ›¼è°·æœ€ç¾æ›¸åº—ï¼Œæœ‰å¾ˆå¥½çš„è¦–é‡å’Œåº§ä½ã€‚"},
        {title:"Yunomori Onsen", type:"æº«æ³‰/Spa", tag:"RELAX", price:"à¸¿550+", open_hours:"09-24", address:"Yunomori Onsen & Spa Sukhumvit 26", coords:[13.7252, 100.5705], note:"å¦‚æœä½ æƒ³æ›å€‹å£å‘³ï¼Œé€™æ˜¯æ­£å®—æ—¥å¼æº«æ³‰+æ³°å¼æŒ‰æ‘©ï¼Œç’°å¢ƒéå¸¸å¯§éœã€‚"},
        {title:"æ¦®æ³°ç±³ç²‰æ¹¯", type:"å°åƒ", tag:"ç¾é£Ÿ", price:"à¸¿60", open_hours:"08-17", address:"Rung Rueang Pork Noodle", coords:[13.7283, 100.5706], note:"ç±³å…¶æ—å¿…æ¯”ç™»æ¨è–¦ï¼ŒPhrom Phong ç«™é™„è¿‘ï¼Œå¿…åƒç¢è‚‰å†¬è”­åŠŸå£å‘³ã€‚"}
    ],
    "shopping": ["Erb è¨‚è£½é¦™æ°´", "è—è±¡èª¿ç†åŒ…", "æ‰‹æ¨™èŒ¶", "Cha Tra Mue"] 
},
"day5": { 
    "date": "2026-04-07", "display": "Apr 07", "weekday": "é€±äºŒ", 
    "events": [ 
        { time: "09:30", title: "æ„›ç¥ & è±¡ç¥", type: "ç¥ˆç¦", price: "-", open_hours: "24H", address: "Central World Shrine", coords: [13.7466, 100.5393], note: "æ¯é€±äºŒ/å››æ™šä¸Š9é»æœ€éˆï¼Œä½†æ—©ä¸Šäººå°‘ã€‚ç´…ç«ç‘°æ‹œæ„›ç¥ï¼Œé»ƒèŠ±æ‹œè±¡ç¥ã€‚", tags: ["æ–‡åŒ–"] },
        { time: "11:30", title: "Saneh Jaan", type: "ç±³å…¶æ—ä¸€æ˜Ÿ", price: "à¸¿2,000", open_hours: "11:30-14", address: "Saneh Jaan", coords: [13.7388, 100.5457], note: "åœ¨ Sindhorn Towerã€‚å‚³çµ±å®®å»·æ³°èœï¼Œéå¸¸ç²¾ç·»ï¼Œä½œç‚ºæ—…ç¨‹çš„å¥é»ã€‚", tags: ["åˆé¤"] },
        { time: "14:30", title: "å‰å¾€æ©Ÿå ´ (BKK)", type: "äº¤é€š", price: "-", open_hours: "-", address: "Suvarnabhumi Airport", coords: [13.6900, 100.7501], note: "å› IR-ON å–è¡Œæã€‚BTS åˆ° Phaya Thai è½‰ ARLã€‚é ç•™ 3 å°æ™‚ä»¥ä¸Šè¼ƒä¿éšªã€‚", tags: ["å›ç¨‹"] }
    ], 
    "inspiration": [], 
    "shopping": ["æ©Ÿå ´å…ç¨…é…’", "Jo Malone"] 
}
};

let currentDay = "day1";
let modalMap = null;
let currentEventData = null;
let exchangeRate = 0.23; // Default fallback
let weatherCache = null;

function init() { 
    renderDateSelector(); selectDay('day1'); 
    switchMainPage('itinerary', document.querySelector('.nav-item.active'));
    fetchRates(); fetchWeather();
}

async function fetchRates(force = false) {
    const rateDisplay = document.getElementById('rate-display-text');
    // ä½¿ç”¨å…è²»çš„ currency-api (jsDelivr CDN)
    try {
        const res = await fetch('https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/thb.json');
        const data = await res.json();
        if(data.thb && data.thb.hkd) {
            exchangeRate = data.thb.hkd;
            rateDisplay.innerHTML = `å³æ™‚: 1 THB â‰ˆ ${exchangeRate.toFixed(4)} HKD`;
            convertCurrency();
        }
    } catch(e) { 
        console.error("Rate Fetch Error", e);
        rateDisplay.innerHTML = `é è¨­: 1 THB = ${exchangeRate} HKD`;
    }
}

function manualRate() {
    const r = prompt("è«‹è¼¸å…¥æ‰‹å‹•åŒ¯ç‡ (THB å° HKD):", exchangeRate);
    if(r && !isNaN(r)) {
        exchangeRate = parseFloat(r);
        document.getElementById('rate-display-text').innerHTML = `æ‰‹å‹•: 1 THB = ${exchangeRate} HKD`;
        convertCurrency();
    }
}

async function fetchWeather() {
    try {
        const url = `https://api.open-meteo.com/v1/forecast?latitude=13.7563&longitude=100.5018&daily=weathercode,temperature_2m_max,temperature_2m_min,precipitation_probability_max,uv_index_max,sunrise,sunset&timezone=auto&forecast_days=14`;
        const res = await fetch(url); weatherCache = await res.json();
        if(document.getElementById('page-weather').classList.contains('active')) renderWeatherModule();
    } catch(e) { document.getElementById('weather-content').innerHTML = "<div style='text-align:center; padding:30px;'>ç„¡æ³•è¼‰å…¥å¤©æ°£</div>"; }
}

function renderWeatherModule() {
    const container = document.getElementById('weather-content');
    const noticeEl = document.getElementById('weather-notice');
    if(!weatherCache || !weatherCache.daily) { container.innerHTML = "<div style='text-align:center; padding:30px;'>ç„¡è³‡æ–™</div>"; return; }
    
    container.innerHTML = `
    <div class="weather-main-card">
    <div class="weather-date">${scheduleData[currentDay].display} â€¢ æ›¼è°·</div>
    <div class="weather-icon-lg" style="color:#f39c12"><i class="fa-solid fa-sun"></i></div>
    <div class="weather-temp-lg">36Â°</div>
    <div class="weather-desc">æ™´æœ—ç‚ç†± / é«”æ„Ÿ 41Â°</div>
    </div>
    <div class="weather-grid">
    <div class="weather-stat-card"><i class="fa-solid fa-droplet" style="color:#3498db"></i><span style="font-size:0.7rem">é™é›¨ 10%</span></div>
    <div class="weather-stat-card"><i class="fa-solid fa-sun" style="color:orange"></i><span style="font-size:0.7rem">UV 11+</span></div>
    </div>
    `;
    noticeEl.innerHTML = "4æœˆæ˜¯æ³°åœ‹æœ€ç†±çš„æœˆä»½ï¼Œè«‹å‹™å¿…å®šæ™‚è£œå……æ°´åˆ†ä¸¦å®‰æ’å®¤å…§è¡Œç¨‹ã€‚";
}

function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); document.getElementById('sidebar-overlay').classList.toggle('open'); }
function openTranslate() { window.open("https://translate.google.com/?sl=auto&tl=zh-TW", "_blank"); }
function navigateTo(pageId) { toggleSidebar(); switchMainPage(pageId); }

function switchMainPage(pageId, navEl) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-' + pageId).classList.add('active');
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    if(navEl) navEl.classList.add('active'); else {
        if(pageId=='itinerary') document.querySelectorAll('.nav-item')[0].classList.add('active');
        if(pageId=='inspiration') document.querySelectorAll('.nav-item')[1].classList.add('active');
        if(pageId=='shopping') document.querySelectorAll('.nav-item')[2].classList.add('active');
        if(pageId=='weather') document.querySelectorAll('.nav-item')[3].classList.add('active');
    }
    const ds = document.querySelector('.date-selector-container');
    if(['itinerary','shopping','inspiration','weather'].includes(pageId)) ds.style.display = 'block'; else ds.style.display = 'none';
    if(pageId === 'weather') renderWeatherModule();
}

function convertCurrency() {
    const thb = parseFloat(document.getElementById('curr-thb').value);
    if(!isNaN(thb)) { document.getElementById('curr-hkd').value = (thb * exchangeRate).toFixed(1); } else { document.getElementById('curr-hkd').value = ""; }
}

function showPhrase(jp, zh) { document.getElementById('overlay-jp').innerText = jp; document.getElementById('overlay-zh').innerText = zh; document.getElementById('phrase-overlay').classList.add('active'); }
function closePhrase() { document.getElementById('phrase-overlay').classList.remove('active'); }

function renderDateSelector() {
    const container = document.getElementById('date-selector'); container.innerHTML = '';
    Object.keys(scheduleData).forEach(dayKey => {
        const day = scheduleData[dayKey];
        const chip = document.createElement('div'); chip.className = `date-chip`;
        chip.onclick = () => selectDay(dayKey, chip);
        chip.innerHTML = `<span class="day-num">${day.display}</span><span class="day-week">${day.weekday}</span>`;
        container.appendChild(chip);
    });
    if(container.firstChild) container.firstChild.classList.add('active');
}

function selectDay(dayKey, chipEl) {
    currentDay = dayKey;
    if(chipEl) { document.querySelectorAll('.date-chip').forEach(c => c.classList.remove('active')); chipEl.classList.add('active'); chipEl.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' }); }
    renderTimeline(dayKey); renderInspiration(dayKey); renderShopping(dayKey);
    if(document.getElementById('page-weather').classList.contains('active')) renderWeatherModule();
}

function renderTimeline(dayKey) {
    const container = document.getElementById('timeline-container'); container.innerHTML = '';
    const events = scheduleData[dayKey].events || [];
    events.forEach(event => {
        const item = document.createElement('div'); item.className = 'timeline-item';
        let tags = event.tags.map(t => `<span class="card-tag">${t}</span>`).join('');
        const navBtn = `<div class="card-nav-btn" onclick="event.stopPropagation(); openMapQuery('${event.address}')"><i class="fa-solid fa-location-arrow"></i></div>`;
        item.innerHTML = `<div class="card" onclick='openModal(${JSON.stringify(event).replace(/'/g, "'")})'>${navBtn}<span class="card-time">${event.time}</span><h3 class="card-title">${event.title}</h3><div class="tags">${tags}</div></div>`;
        container.appendChild(item);
    });
    container.appendChild(document.createElement('div')).style.height = "20px";
}

function renderInspiration(dayKey) {
    const container = document.getElementById('inspiration-container'); container.innerHTML = '';
    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
    document.querySelector('.filter-chip').classList.add('active');
    const items = scheduleData[dayKey].inspiration || [];
    if(items.length === 0) { container.innerHTML = "<div style='padding:20px; text-align:center; color:#999;'>æœ¬æ—¥è¡Œç¨‹å……å¯¦ï¼Œç„¡éœ€å‚™æ¡ˆ</div>"; return;}
    items.forEach(item => {
        container.innerHTML += `<div class="inspire-card" data-tag="${item.tag}" onclick='openModal(${JSON.stringify(item).replace(/'/g, "'")})'><div class="inspire-badge">${item.tag}</div><h3 class="inspire-title">${item.title}</h3><p class="inspire-desc">${item.note}</p></div>`;
    });
}

function filterInspiration(tag, btn) {
    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active')); btn.classList.add('active');
    document.querySelectorAll('.inspire-card').forEach(card => { if(tag === 'all' || card.getAttribute('data-tag') === tag) card.classList.remove('hidden'); else card.classList.add('hidden'); });
}

function renderShopping(dayKey) {
    const container = document.getElementById('shopping-container'); container.innerHTML = '';
    (scheduleData[dayKey].shopping || []).forEach((item, idx) => { container.innerHTML += `<div class="shop-item"><input type="checkbox" id="s${idx}"><label for="s${idx}">${item}</label></div>`; });
}

function openMapQuery(address) { 
    window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`, '_blank'); 
}

function openModal(data) {
    currentEventData = data;
    document.getElementById('modal-title').innerText = data.title;
    document.getElementById('modal-type').innerText = data.type || "Event";
    document.getElementById('modal-time').innerText = data.time || "å½ˆæ€§æ™‚é–“";
    document.getElementById('modal-price').innerText = data.price || "-";
    document.getElementById('modal-open-hours').innerText = data.open_hours || "å¾…ç¢ºèª";
    document.getElementById('modal-address-short').innerText = data.address;
    document.getElementById('modal-note').innerText = data.note;
    
    const actionsContainer = document.getElementById('modal-actions');
    actionsContainer.innerHTML = '';
    
    if (data.type.includes('ç¾é£Ÿ') || data.type.includes('é¤å»³') || data.type.includes('Buffet') || data.type.includes('Spa')) {
        actionsContainer.innerHTML += `<button class="btn-action btn-black" onclick="window.open('https://mail.google.com/mail/u/0/#search/${encodeURIComponent(data.title)}', '_blank')"><i class="fa-solid fa-envelope"></i> æœå°‹é ç´„ä¿¡ (Gmail)</button>`;
    }
    
    actionsContainer.innerHTML += `<button class="btn-action btn-black" style="background:var(--accent); color:white;" onclick="showPhrase('${data.address}', 'è«‹è¼‰æˆ‘å»é€™è£¡')"><i class="fa-solid fa-taxi"></i> é¡¯ç¤ºåœ°å€ (çµ¦å¸æ©Ÿçœ‹)</button>`;
    
    if(data.coords) {
        const grabLink = `https://grab.onelink.me/2695613898?pid=google-maps&c=ride&is_retargeting=true&af_dp=grab%3A%2F%2Fopen%3FscreenType%3DBOOKING%26dropOffLatitude%3D${data.coords[0]}%26dropOffLongitude%3D${data.coords[1]}`;
        actionsContainer.innerHTML += `<a href="${grabLink}" class="btn-action btn-grab"><i class="fa-solid fa-car"></i> å« Grab (è¨­å®šçµ‚é»)</a>`;
    }

    document.getElementById('detail-modal').classList.add('open');
    setTimeout(() => { 
        if(modalMap) modalMap.remove(); 
        if(data.coords) {
            modalMap = L.map('modal-mini-map', {zoomControl:false, dragging:false}).setView(data.coords, 15); 
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(modalMap); 
            L.marker(data.coords, {icon: L.divIcon({className:'custom-div-icon',html:"<div style='background:#D4AF37;width:14px;height:14px;border-radius:50%;border:2px solid white;box-shadow:0 2px 5px rgba(0,0,0,0.3);'></div>",iconSize:[14,14]})}).addTo(modalMap); 
            modalMap.invalidateSize(); 
        }
    }, 100);
}

function closeModal() { document.getElementById('detail-modal').classList.remove('open'); }
document.getElementById('detail-modal').addEventListener('click', function(e) { if (e.target === this) closeModal(); });

init();
</script>
</body>
</html>
